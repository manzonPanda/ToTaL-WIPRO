<!DOCTYPE html>
<html>
<head>
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.3/css/bootstrap.min.css" integrity="sha384-Zug+QiDoJOrZ5t4lssLdxGhVrurbmBWopoEl+M6BdEfwnCJZtKxi1KgxUyJq13dy" crossorigin="anonymous">
 <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.3/js/bootstrap.min.js"></script>



</head>
<body>
<!--https://www.mathsisfun.com/combinatorics/combinations-permutations-calculator.html  Combinations and Permutations Calculator  -->
<!--https://delim.co/#   link to Comma Separating Tool-->
<div class="container">	
	<h5 style="font-weight:bold;">Total Combination with Required URL Parameter: <span id="totalCount"></span></h5>
	<div class="row">
		<div class="col-sm">
			<input type="file" id="file">
			<button onclick="clickButton()">Calculate</button>
		</div>
		<div class="col-sm">
			<textarea style="width:450px;height: 50px" id="myTextArea"></textarea>
			<button onclick="combination()">Calculate</button>
		</div>
		
	</div>
</div> 
 <hr>
  
<div class="container" id="result" ></div>

</body>
</html>

<script>
var input = document.getElementById("file");
var output = document.getElementById("output");

var list = [];
input.addEventListener("change", function () {
  if (this.files && this.files[0]) {
    var myFile = this.files[0];
    var reader = new FileReader();
    
	reader.onload = function (progressEvent) {
		// Entire file
		//console.log(this.result);
		// By lines
		var lines = this.result.split('\n');
		
		for (var line = 0; line < lines.length; line++) {
			list.push(lines[line]);
		}
		
	};
    <!-- reader.readAsText(file); -->
	
	
    <!-- reader.addEventListener('load', function (e) { -->
      <!-- output.textContent = e.target.result; -->
    <!-- }); -->
    reader.readAsBinaryString(myFile);
  }   
});

//required
var groupByCount = 0
var  areaCount = 0
var  perspectiveCount = 0
var  timeCount = 0
var customDateCount = 0
//not required
var filterFacility=0
var filterTechnology=0
var filterSBE=0
var filterDevice=0
var filterLot=0
var total = 0;

function clickButton(){
	console.log(list.length)
	//document.getElementById("result").innerHTML += list[2]
	for(var i=0; i <list.length; i++){
		reset()
		var urlList = list[i].split(",")
		
		for( var j=0; j < urlList.length; j++ ){
			if(urlList[j].split("=")[0] == "groupBy"){
				groupByCount++;
			}else if(urlList[j].split("=")[0] == "area"){
				areaCount++
			}else if(urlList[j].split("=")[0] == "perspective"){
				perspectiveCount++
			}else if(urlList[j].split("=")[0] == "time"){
				timeCount++
			}else if(urlList[j].split("=")[0] == "customDate"){
				customDateCount++
			}else if(urlList[j].split("=")[0] == "fabLocation"){
				filterFacility++
			}else if(urlList[j].split("=")[0] == "fabFacility"){
				filterFacility++
			}else if(urlList[j].split("=")[0] == "probeLocation"){
				filterFacility++
			}else if(urlList[j].split("=")[0] == "probeFacility"){
				filterFacility++
			}else if(urlList[j].split("=")[0] == "prtech"){
				filterTechnology++
			}else if(urlList[j].split("=")[0] == "tech"){
				filterTechnology++
			}else if(urlList[j].split("=")[0] == "ctech"){
				filterTechnology++
			}else if(urlList[j].split("=")[0] == "sbe"){
				filterSBE++
			}else if(urlList[j].split("=")[0] == "sbe1"){
				filterSBE++
			}else if(urlList[j].split("=")[0] == "sbe2"){
				filterSBE++
			}else if(urlList[j].split("=")[0] == "device"){
				filterDevice++
			}else if(urlList[j].split("=")[0] == "material"){
				filterDevice++
			}else if(urlList[j].split("=")[0] == "chipname"){
				filterDevice++
			}else if(urlList[j].split("=")[0] == "fablot"){
				filterLot++
			}else if(urlList[j].split("=")[0] == "lot"){
				filterLot++
			}
		}
		if(groupByCount==1 && areaCount==1 && perspectiveCount==1 && timeCount==1 && customDateCount==1){
			document.getElementById("result").innerHTML += list[i]+"<br>"
			total++;
		}	
	}
	document.getElementById("totalCount").innerHTML = total
	document.getElementById("totalCount").parentNode.setAttribute("style","font-weight:bold;color: green")

}

//combination()
function combination(){
var combinationList = document.getElementById("myTextArea").value.replace(/\r\n/g,"\n").split("\n")
//var combinationList = document.getElementById("myTextArea").value
//document.getElementById("result").innerHTML += combinationList[0].split(",")[0]
for(var i=0; i <combinationList.length; i++){
	reset()
	var urlList = combinationList[i].split(",")
	
	for( var j=0; j < urlList.length; j++ ){
		if(urlList[j].split("=")[0] == "groupBy"){
			groupByCount++;
		}else if(urlList[j].split("=")[0] == "area"){
			areaCount++
		}else if(urlList[j].split("=")[0] == "perspective"){
			perspectiveCount++
		}else if(urlList[j].split("=")[0] == "time"){
			timeCount++
		}else if(urlList[j].split("=")[0] == "customDate"){
			customDateCount++
		}
	}
	if(groupByCount==1 && areaCount==1 && perspectiveCount==1 && timeCount==1 && customDateCount==1){
		document.getElementById("result").innerHTML += "http://total.itg.ti.com/ToTaL/?"+checkEscapeCode(combinationList[i])+"<br>"
		//document.getElementById("result").innerHTML += combinationList[i]+"<br>"
		total++;
	}

//document.getElementById("result").innerHTML += combinationList[index] +"<br>"
}
document.getElementById("totalCount").innerHTML = total
document.getElementById("totalCount").parentNode.setAttribute("style","font-weight:bold;color: green")

}
//groupBy=FAC,area=TEST,perspective=Fab,time=dallas,customDate=2020-03-18 to 2020-05-23
function checkEscapeCode(combinationList){
	var parameterValue = combinationList.split(",")
	var url = ""
	for(var i=0; i<parameterValue.length; i++){
		if( parameterValue[i].split("=").length > 2 ){
			url += "&"+parameterValue[i].split("=")[0]+"="+escapedCode(parameterValue[i].substring(parameterValue[i].indexOf("=")+1)) 
		}else{
			url += "&"+parameterValue[i].split("=")[0]+"="+escapedCode(parameterValue[i].split("=")[1])
		}
	}
	return url
}
//MTD
//General Pattern:: str.split(search).join(replacement)
function escapedCode(valueOfParameter){
	return valueOfParameter.split("=").join("%3D")
}



function reset(){
//required
groupByCount = 0
areaCount = 0
perspectiveCount = 0
timeCount = 0
customDateCount = 0
//not required
filterFacility=0
filterTechnology=0
filterSBE=0
filterDevice=0
filterLot=0

}


/*
var groupBy = ["groupBy=FAC",
"groupBy=LOC",
"groupBy=PRTECH",
"groupBy=TECH",
"groupBy=CTECH",
"groupBy=SBE",
"groupBy=SBE_1",
"groupBy=SBE_2",
"groupBy=MATERIAL",
"groupBy=DEVICE",
"groupBy=CHIP",
"groupBy=FABLOT",
"groupBy=LOT",]

var area = ["area=TEST",
"area=ASSY",
"area=SORT",
"area=FAB"]

var perspective = ["perspective=Fab",
"perspective=AT"]

var time = ["time=dallas",
"time=local"]

var tranDate = ["customDate=2020/04/01-2020/05/19",
"customDate=L90D",
"customDate=L30D",
"customDate=LM",
"customDate=LQ",
"customDate=MTD",
"customDate=QTD",
"customDate=YTD"]
*/





























</script>














